#!/usr/bin/python3
from hackeriet import vending
import logging
import config
import os
from hashlib import sha1
os.putenv("LIBNFC_LOG_LEVEL", "0")
from hackeriet import mifare

logging.basicConfig(level=logging.DEBUG,format='%(asctime)-15s %(message)s')

if hasattr(config, "keyA"): mifare.keyA = config.keyA
if hasattr(config, "keyB"): mifare.keyB = config.keyB

while True:
  vending.ready()
  user_data = mifare.try_read()
  if user_data:
    vending.not_ready()
    logging.info("Velg produkt")
    s = vending.select_product()
    logging.info("%d valgt" % s)
    if s > -1:
      vending.vend_product(s)


